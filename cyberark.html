<!DOCTYPE html>
<html>
<head>
	<title>Verizon Framework v4</title>
	<link rel="stylesheet" type="text/css" href="assets/reset.css">
	<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">
	<link rel="stylesheet" type="text/css" href="assets/style.css">
</head>
<body>
	<div class="navBox">	
		<ul class="nav justify-content-center nav-pills">
		  <li class="nav-item">
		    <a class="nav-link" href="index.html">Intro</a>
		  </li>
		  <li class="nav-item">
		    <a class="nav-link" href="modular.html">Modular</a>
		  </li>
		  <li class="nav-item">
		    <a class="nav-link" href="xml.html">XML</a>
		  </li>
		  <li class="nav-item">
		    <a class="nav-link active" href="cyberark.html">CyberArk</a>
		  </li>
		  <li class="nav-item">
		    <a class="nav-link" href="logging.html">Logging</a>
		  </li>
		  <li class="nav-item">
		    <a class="nav-link" href="variables.html">Variables</a>
		  </li>
		  <li class="nav-item">
		    <a class="nav-link documentationLink" href="documentation.html">Documentation</a>
		  </li>
		  <li class="nav-item">
		    <a class="nav-link" href="tips.html">Tips</a>
		  </li>
		</ul>
	</div>
	<div class="container-fluid">
		<div class="jumbotron">	
			<h1 class="display-3 text-center"><img class = "img-responsive" src="assets/images/vzLogo.png">Framework v4</h1>
			<hr class="my-4">
			<h2 class="text-center pageTitle">CyberArk</h2>
			<p class="text-center">CyberArk is a tool which is used to provide credentials to the automations which can be utilized during an approved process. </p>
			<div class="updatesBox">
				<hr class="my-4">
				<h2 class="heading">Latest Changes</h2>
				<ul class="list-group">
				  <li class="list-group-item">CyberArk Vault is picked dynamically, based on the name in the XML script.</li>
				  <li class="list-group-item">The VBS script for the prescribed vault is downloaded when the project is initialized in the framework.</li>
				</ul>
			</div>
			<div class = "cyberArkInfoBox contentBox">
				<hr class="my-4">
				<h2 class="heading">CyberArk General Info</h2>
				<p>The password is passed to the Framework through a VBS script in the XML/CyberArk Subtask. There is a RunScript task which utilizes the local CyberArk application to communicate to the remote vault. The vault validates the local machineâ€™s information, as well as the credential being requested, and will return the password if valid. This password will be stored in the vPassword variable and passed to the Main Task so that it can be utilized throughout the other subtasks.</p>
			</div>
			<div class = "cyberArkInfoBox contentBox">
				<hr class="my-4">
				<h2 class="heading">VBS Script</h2>
				<code>
					Dim objShell, pathToTXTFile, uname, strNewText, ObjExec, cmdLineInput<br><br>
					Set objShell = WScript.CreateObject("WScript.Shell")<br><br>
					uname = WScript.Arguments.Item(0)<br><br>
					Set objExecObject = objShell.Exec("cmd /c ""C:\Program Files (x86)\CyberArk\ApplicationPasswordSdk\CLIPasswordSDK64.exe"" GetPassword /p AppDescs.AppID=AutoAny /p Query=Safe=VZW_AutoAny_ADUO;Folder=Root;UserName="&uname&" /o Password")<br><br>
					strText = ""<br>
					Do While Not objExecObject.StdOut.AtEndOfStream<br>
					&nbsp;strText = strText & objExecObject.StdOut.ReadLine()<br>
					Loop<br><br>
					WScript.StdOut.WriteLine(strText)

				</code>
			</div>
			<div class="resourcesBox">
				<hr class="my-4">
				<h2 class="externalResources">External Resources</h2>
				<ul class="list-group">
				  <li class="list-group-item"><a href=""></a></li>
				</ul>
			</div>
		</div>
	</div>
	<div id="contactBox">
		<ul class="nav justify-content-center nav-pills">
			<li class="nav-item">
			    <!-- <a class="nav-link contactPill" href="index.html">Contact</a> -->
				<a class="nav-link contactPill" href="mailto:william.reed@one.verizon.com?Subject=FrameWork_Question" target="_top">Contact</a>
			</li>
		</ul>
	</div>
</body>
</html>